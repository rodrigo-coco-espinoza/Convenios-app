{% extends 'layout.html' %}
{% block content %}
<div class="content-section mx-2">
  <!-- Tabla recepciones del mes -->
  <legend class="border-bottom mb-3">Recepción de información pendiente Mayo</legend>
  <table class="table table-striped table-hover mb-5">
    <thead class='table-dark'>
      <tr>
        <th scope='col'>#</th>
        <th scope='col'>Institución</th>
        <th scope='col'>Convenio</th>
        <th scope='col'>Entrega</th>
        <th scope='col'>Archivo</th>
        <th scope='col'>Respuesta</th>
        <th scope='col'>Nota</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>1</td>
        <td>IPS</td>
        <td>(Ad) Entregas Semanales</td>
        <td>Información de pensionados</td>
        <td>info_pensionados_mm_aaaa.csv</td>
        <td>...</td>
        <td><input type="text" name="" value=""></td>
      </tr>
      <tr>
        <td>2</td>
        <td>FOGAPE</td>
        <td>Intercambio de Información</td>
        <td>Créditos otorgados</td>
        <td>creditos_mm.txt</td>
        <td>...</td>
        <td><input type="text" name="" value=""></td>
      </tr>
      <tr>
        <td>3</td>
        <td>INDAP</td>
        <td>Convenio</td>
        <td>Catastro de vacas</td>
        <td>catastro_vacas.csv</td>
        <td>...</td>
        <td><input type="text" name="" value=""></td>
      </tr>
    </tbody>
  </table>
  <!-- Tabla recepciones atrasadas -->
  <legend class="border-bottom mb-3">Recepción de información atrasadas</legend>
  <table class="table table-striped table-hover mb-5">
    <thead class='table-dark'>
      <tr>
        <th scope='col'>#</th>
        <th scope='col'>Institución</th>
        <th scope='col'>Convenio</th>
        <th scope='col'>Entrega</th>
        <th scope='col'>Archivo</th>
        <th scope='col'>Mes</th>
        <th scope='col'>Respuesta</th>
        <th scope='col'>Nota</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>1</td>
        <td>IPS</td>
        <td>(Ad) Entregas Semanales</td>
        <td>Información de pensionados</td>
        <td>info_pensionados_mm_aaaa.csv</td>
        <td>Abril</td>
        <td>...</td>
        <td><input type="text" name="" value=""></td>
      </tr>
      <tr>
        <td>2</td>
        <td>FOGAPE</td>
        <td>Intercambio de Información</td>
        <td>Créditos otorgados</td>
        <td>creditos_mm.txt</td>
        <td>Marzo</td>
        <td>...</td>
        <td><input type="text" name="" value=""></td>
      </tr>
    </tbody>
  </table>

  <!-- Tabla convenios asignados -->
  <legend class="border-bottom mb-3">Convenios asignados a {{ equipo.sigla }}</legend>
  {% if convenios_asignados %}
    <table class="table table-striped table-hover mb-5">
    <thead class='table-dark'>
      <th scope='col'>#</th>
      <th scope='col'>Nombre convenio</th>
      <th class="text-center" scope='col'>Días en área</th>
      <th scope='col'>Etapa actual</th>
    </thead>
    <tbody>
      {% for convenio in convenios_asignados %}
        <tr>
          <th> {{ loop.index }}</th>
          <td><a style='text-decoration: none; color: #000;' href="{{ url_for('informes.detalle_convenio_en_proceso', id_convenio=convenio.id) }}">{{ convenio.nombre }} <i class="fas fa-search btn-sm"></a></td>
          <td class='text-center'>{{ convenio.dias_area }}</td>
          <td>{{ convenio.etapa }}</td>
        </tr>
      {% endfor %}
    </tbody>
    </table>
  {% else %}
    <p class="mb-5">No hay convenios asignados a {{ equipo.sigla }} actualmente.</p>
  {% endif %}
  <!-- Tabla estado actual convenios asociados a SD -->
  <legend class="border-bottom mb-3">Estado actual convenios de {{ equipo.sigla }}</legend>
  <div  class="mb-5 overflow-auto" style="height: 700px;">
    <div id='tablaEstadoActual'></div>
  </div>
</div>

<!-- Tabla estado actual de convenios -->
<script type="text/javascript">
  google.charts.load('current', {'packages': ['table']});
  google.charts.setOnLoadCallback(drawChart);
  function drawChart() {
    var dataTablaEstadoActual = new google.visualization.DataTable();
    dataTablaEstadoActual.addColumn('string', 'Convenio');
    dataTablaEstadoActual.addColumn('string', 'Estado');
    dataTablaEstadoActual.addColumn('string', 'Última observación');
    dataTablaEstadoActual.addColumn('string', 'Coordinador');
    dataTablaEstadoActual.addColumn('string', 'Ver res.');

    var listado_convenios = {{ tabla_convenios_asociados | tojson }}

    dataTablaEstadoActual.addRows(listado_convenios);
    dataTablaEstadoActual.setProperty(0, 0, 'style', 'width: 310px');
    optionsTablaEstadoActual = {
      allowHtml: true,
      width: '100%'
    };
    var tablaEstadoActual = new google.visualization.Table(document.getElementById('tablaEstadoActual'));
    tablaEstadoActual.draw(dataTablaEstadoActual, optionsTablaEstadoActual);
  }
</script>

{% endblock content %}
